(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-370b3b12"],{2975:function(e,t,n){},"3ad6":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"font-roboto bg-gray-100 overflow-auto",staticStyle:{height:"80%"}},[n("div",{staticClass:"px-6 py-8"},[n("div",{staticClass:"flex justify-center container mx-auto"},[n("div",{staticClass:"w-full lg:w-8/12"},[n("div",{staticClass:"mt-6"},[n("div",{staticClass:"max-w-4xl px-10 py-6 bg-white rounded-lg shadow-md"},[n("h1",{staticClass:"text-4xl text-gray-700 font-bold"},[e._v(" "+e._s(e.article.title)+" ")]),n("div",{staticClass:"flex items-center"},[n("img",{staticClass:"mx-4 w-10 h-10 object-cover rounded-full hidden sm:block",attrs:{src:e.article.User.photo||e.fakePhoto,alt:"avatar"}}),n("h2",{staticClass:"text-gray-700 font-bold"},[e._v(" "+e._s(e.article.User.name)+" ")])]),n("div",{}),n("div",{staticClass:"flex justify-between items-center"},[n("span",{staticClass:"font-light text-gray-600"},[e._v(e._s(e.relativeTimeFromNow(e.article.createdAt)))]),n("router-link",{staticClass:"px-2 py-1 bg-gray-600 text-gray-100 font-bold rounded hover:bg-gray-500",attrs:{to:{name:"categories",params:{id:e.article.Category.id}}}},[e._v(e._s(e.article.Category.name))])],1),n("div",{staticClass:"mt-2"},[n("div",{},[n("p",{staticClass:"mt-2 text-orange-500"},[e._v(" 觀看權限: "+e._s(e.article.permission)+" ")])]),n("p",{staticClass:"mt-2 text-gray-600 truncate"},[e._v(e._s(e.article.content))])]),n("div",{staticClass:"flex justify-between items-center mt-4"},[n("p",{staticClass:"mt-2 text-gray-600"}),n("div",[n("button",{staticClass:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-yellow-600 rounded-lg hover:bg-yellow-500 focus:outline-none focus:ring focus:ring-yellow-300 focus:ring-opacity-80 mr-5",on:{click:function(t){e.isShowResponse=!e.isShowResponse}}},[e._v(" 回覆 ")]),e.currentUser.id===e.article.User.id?[n("button",{staticClass:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-blue-600 rounded-lg hover:bg-blue-500 focus:outline-none focus:ring focus:ring-blue-300 focus:ring-opacity-80 mr-5"},[n("router-link",{attrs:{to:{name:"edit-article",params:{id:e.article.id}}}},[e._v("編輯")])],1),n("button",{staticClass:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-red-600 rounded-lg hover:bg-red-500 focus:outline-none focus:ring focus:ring-red-300 focus:ring-opacity-80",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.removeArticle(e.article.id,e.article.title)}}},[e._v(" 刪除 ")])]:e._e()],2)])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowResponse,expression:"isShowResponse"}],staticClass:"max-w-4xl px-10 py-6 rounded-lg shadow-md mt-5"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[n("p",[e._v(e._s(e.currentUser.name)+" 想回覆")]),n("el-input",{staticClass:"mt-4",attrs:{type:"textarea",autosize:{minRows:2}},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}),e.isProcessing?n("el-button",{staticClass:"w-24",attrs:{type:"primary"}},[n("span",{staticClass:"spinner small-spinner"})]):n("el-button",{staticClass:"w-24 mt-3",attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit(e.article.id)}}},[e._v("送出回覆")])],1)],1)])])]),e._m(0),e._l(e.article.Responses,(function(t){var r=t.content,s=t.id,i=t.createdAt,a=t.User;return n("div",{key:s,staticClass:"flex justify-center container mx-auto"},[n("div",{staticClass:"w-full lg:w-8/12"},[n("div",{staticClass:"mt-6"},[n("div",{staticClass:"max-w-4xl px-10 py-6 bg-white rounded-lg shadow-md"},[n("div",{staticClass:"flex items-center"},[n("img",{staticClass:"mx-4 w-10 h-10 object-cover rounded-full hidden sm:block",attrs:{src:a.photo||e.fakePhoto,alt:"avatar"}}),n("h2",{staticClass:"text-gray-700 font-bold hover:underline"},[e._v(" "+e._s(a.name)+" ")])]),n("span",{staticClass:"font-light text-gray-600"},[e._v(e._s(e.relativeTimeFromNow(i)))]),n("h1",{staticClass:"text-2xl text-gray-700"},[e._v(" "+e._s(r)+" ")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentUser.id===a.id,expression:"currentUser.id === User.id"}],staticClass:"flex justify-end items-center mt-4"},[n("button",{staticClass:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-blue-600 rounded-lg hover:bg-blue-500 focus:outline-none focus:ring focus:ring-blue-300 focus:ring-opacity-80 mr-5",on:{click:function(t){e.dialogVisible=!0,e.editResponseId=s,e.reviseForm.content=r}}},[e._v(" 編輯 ")]),n("button",{staticClass:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-red-600 rounded-lg hover:bg-red-500 focus:outline-none focus:ring focus:ring-red-300 focus:ring-opacity-80",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.removeReponse(s,r)}}},[e._v(" 刪除 ")])])])])])])})),n("el-dialog",{attrs:{title:"回覆",visible:e.dialogVisible,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("span",[e._v("修改內容為")]),n("el-input",{staticClass:"mt-2",attrs:{type:"textarea",autosize:{minRows:2}},model:{value:e.reviseForm.content,callback:function(t){e.$set(e.reviseForm,"content",t)},expression:"reviseForm.content"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editResponse()}}},[e._v("送出")])],1)],1)],2)])},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex justify-center container mx-auto"},[n("div",{staticClass:"w-full lg:w-8/12"},[n("div",{staticClass:"mt-6"},[n("div",{staticClass:"max-w-4xl px-10 py-6 bg-white rounded-lg shadow-md"},[n("h3",{staticClass:"text-xl text-gray-700"},[e._v("回覆")])])])])])}],i=(n("4de4"),n("c740"),n("b0c0"),n("5530")),a=(n("96cf"),n("1da1")),o=n("18a8"),c=n("2fa3"),l={postResponse:function(e,t){return c["b"].post("/responses/".concat(e),Object(i["a"])({},t))},putResponse:function(e,t){return c["b"].put("/responses/".concat(e),Object(i["a"])({},t))},deleteResponse:function(e){return c["b"].delete("/responses/".concat(e))}},u=n("2f62"),d=n("3d20"),f=n.n(d),p=n("5fb0"),m={name:"Article",data:function(){return{article:{Category:{name:""},Responses:[{User:{name:""}}],User:{name:""}},relativeTimeFromNow:c["d"],isDeleteProcessing:!1,isShowResponse:!1,form:{content:""},isProcessing:!1,dialogVisible:!1,editResponseId:0,editResponseContent:"",reviseForm:{content:""},fakePhoto:p["a"]}},created:function(){var e=this.$route.params.id;this.fetchArticle(e)},methods:{fetchArticle:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.isLoading=!0,n.next=4,o["a"].getArticle({id:e});case 4:r=n.sent,s=r.data,t.article=s.article,t.isLoading=!1,n.next=14;break;case 10:n.prev=10,n.t0=n["catch"](0),t.isLoading=!1,c["a"].fire({icon:"error",title:"無法閱讀此文章，請稍後再試"});case 14:case"end":return n.stop()}}),n,null,[[0,10]])})))()},removeArticle:function(e,t){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:f.a.fire({text:"確定要刪除 ".concat(t," 這篇文章嗎?"),icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:"確定",customClass:{confirmButton:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-red-600 rounded-lg hover:bg-red-500 focus:outline-none focus:ring focus:ring-red-300 focus:ring-opacity-80",cancelButton:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-green-600 rounded-lg hover:bg-green-500 focus:outline-none focus:ring focus:ring-green-300 focus:ring-opacity-80 mr-5"},cancelButtonText:"取消",reverseButtons:!0,allowOutsideClick:!1,heightAuto:!1}).then(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var s,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.isConfirmed){t.next=15;break}return t.prev=1,n.isDeleteProcessing=!0,t.next=5,o["a"].deletArticle(e);case 5:s=t.sent,i=s.data,!0===i.success&&(c["a"].fire({icon:"success",title:"刪除文章成功"}),setTimeout((function(){return n.$router.push("/articles")}),1e3)),t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](1),n.isDeleteProcessing=!1,a=t.t0.response.data.message,c["a"].fire({icon:"error",title:a||"無法刪除文章，請稍後再試"});case 15:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},handleSubmit:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s,a,o,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.isProcessing=!0,r=t.form.content,n.next=5,l.postResponse(e,{content:r});case 5:s=n.sent,a=s.data,!0===a.success&&(o=Object(i["a"])(Object(i["a"])({},a.response),{},{User:{name:t.currentUser.name,id:t.currentUser.id}}),t.article.Responses.unshift(o),t.form.content=""),t.isProcessing=!1,n.next=16;break;case 11:n.prev=11,n.t0=n["catch"](0),t.isProcessing=!1,u=n.t0.response.data.message,c["a"].fire({icon:"error",title:u||"無法回覆文章"});case 16:case"end":return n.stop()}}),n,null,[[0,11]])})))()},editResponse:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,s,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=e.reviseForm.content,t.next=4,l.putResponse(e.editResponseId,{content:n});case 4:r=t.sent,s=r.data,!0===s.success&&(i=e.article.Responses.findIndex((function(t){return t.id===e.editResponseId})),e.article.Responses[i].content=n,c["a"].fire({icon:"success",title:"編輯回覆成功"})),e.dialogVisible=!1,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),a=t.t0.response.data.message,c["a"].fire({icon:"error",title:a||"無法編輯回覆"});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},removeReponse:function(e,t){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:f.a.fire({text:"確定要刪除 ".concat(t," 這篇回復嗎?"),icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:"確定",customClass:{confirmButton:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-red-600 rounded-lg hover:bg-red-500 focus:outline-none focus:ring focus:ring-red-300 focus:ring-opacity-80",cancelButton:"px-6 py-2 font-medium tracking-wide text-white capitalize transition-colors duration-300 transform bg-green-600 rounded-lg hover:bg-green-500 focus:outline-none focus:ring focus:ring-green-300 focus:ring-opacity-80 mr-5"},cancelButtonText:"取消",reverseButtons:!0,allowOutsideClick:!1,heightAuto:!1}).then(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var s,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.isConfirmed){t.next=13;break}return t.prev=1,t.next=4,l.deleteResponse(e);case 4:s=t.sent,i=s.data,!0===i.success&&(c["a"].fire({icon:"success",title:"刪除回覆成功"}),n.article.Responses=n.article.Responses.filter((function(t){return t.id!==e}))),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),a=t.t0.response.data.message,c["a"].fire({icon:"error",title:a||"無法刪除回覆，請稍後再試"});case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()}},computed:Object(i["a"])({},Object(u["b"])(["currentUser","isAuthenticated"]))},g=m,v=(n("9451"),n("2877")),h=Object(v["a"])(g,r,s,!1,null,"2a4f04ba",null);t["default"]=h.exports},9451:function(e,t,n){"use strict";var r=n("2975"),s=n.n(r);s.a}}]);
//# sourceMappingURL=chunk-370b3b12.3ed7cc25.js.map